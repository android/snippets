/*
 * Copyright 2025 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

{
  "snippets": [
    {
      "DigitalAssetLinking":
    // Digital asset linking
    // [START android_identity_assetlinks_json]
      [
        {
          "relation": [
            "delegate_permission/common.handle_all_urls",
            "delegate_permission/common.get_login_creds"
          ],
          "target": {
            "namespace": "android_app",
            "package_name": "com.example.android",
            "sha256_cert_fingerprints": [
              SHA_HEX_VALUE
            ]
          }
        }
      ]
    // [END android_identity_assetlinks_json]
    },

    {
      "FormatJsonRequestPasskey":
      // JSON request format
      // [START android_identity_format_json_request_passkey]
      {
        "challenge": "T1xCsnxM2DNL2KdK5CLa6fMhD7OBqho6syzInk_n-Uo",
        "allowCredentials": [],
        "timeout": 1800000,
        "userVerification": "required",
        "rpId": "https://passkeys-codelab.glitch.me/"
      }
      // [END android_identity_format_json_request_passkey]
    },

    {
      "FormatJsonResponsePasskey":
      // JSON response format
      // [START android_identity_format_json_response_passkey]
      {
        "id": "<credential_id>",
        "type": "public-key",
        "rawId": "<raw_credential_id>",
        "response": {
          "clientDataJSON": "<signed_client_data_containing_challenge>",
          "authenticatorData": "<authenticator_metadata_and_signed_hash>",
          "signature": "digital_signature_to_be_verified",
          "userHandle": "user_id_from_credential_registration"
        }
      }
      // [END android_identity_format_json_response_passkey]
    },
    {
      "CreatePasskeyJsonRequest":
      // Json request for creating a passkey
      // [START android_identity_create_passkey_request_json]
      {
        "challenge": "<base64url-encoded challenge>",
        "rp": {
          "name": "<relying party name>",
          "id": "<relying party host name>"
        },
        "user": {
          "id": "<base64url-encoded user ID>",
          "name": "<user name string>",
          "displayName": "<user display name>"
        },
        "pubKeyCredParams": [
          {
            "type": "public-key",
            "alg": -7
          }
        ],
        "attestation": "none",
        "excludeCredentials": [
          {
              "id": "<base64url-encoded credential ID to exclude>", 
              "type": "public-key"
          }
        ],
        "authenticatorSelection": {
          "requireResidentKey": true,
          "residentKey": "required",
          "userVerification": "required"
        }
      }
      // [END android_identity_create_passkey_request_json]
    },
    {
      "CreatePasskeyHandleJsonResponse":
      // Json response when creating a passkey
      // [START android_identity_create_passkey_response_json]
      {
        "id": "<identifier String>",
        "type": "public-key",
        "rawId": "<identifier String>",
        "response": {
          "clientDataJSON": "<ArrayBuffer encoded object with the origin and signed challenge>",
          "attestationObject": "<ArrayBuffer encoded object with the public key and other information.>"
        },
        "authenticatorAttachment": "platform"
      }
      // [END android_identity_create_passkey_response_json]
    },
    {
      "SignInJsonRequest":
      //Json object sent by server when creating sign-in request
      // [START android_identity_create_sign_in_request_json]
      {
        "challenge": "<your app challenge or challenge string>",
        "allowCredentials": [],
        "rpId": "<your app server domain>"
      }
        // [END android_identity_create_sign_in_request_json]
      }
  ]
}